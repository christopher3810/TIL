***

### VPC(Virtual Private Cloud) 


![vpc](https://user-images.githubusercontent.com/61622657/224579510-3ef09d41-c6a3-4f78-bc5f-95a045e5df2b.png)



VPC(가상 프라이빗 클라우드)를 사용하면 클라우드에 네트워크 인프라를 생성할 수 있으며, 네트워크를 각각 고유한 라우트 테이블, 인터넷 게이트웨이, NAT 게이트웨이, 인그레스 전용 게이트웨이를 갖춘 더 작은 서브넷으로 세분화할 수 있습니다.

### VPC 내 IP 범위 분할을 위한 서브넷

서브넷은 VPC 내에서 사용되는 프라이빗 IP 범위를 더 세분화하여 더 많은 네트워크 세그먼트를 생성하는 데 사용됩니다. \
각 서브넷은 가용성 영역 내에 존재하며 RDS 및 EC2 인스턴스와 같은 리소스를 호스팅할 수 있습니다. \
인터넷에 연결된 서브넷을 공용 서브넷이라고 하고, 인터넷에 연결되지 않은 서브넷을 사설 서브넷이라고 합니다.


### 라우팅 테이블과 라우터 

네네트워크 요청이 이루어지면 데이터는 먼저 목적지 역할을 하는 라우터로 이동합니다. \
라우팅 테이블은 각 목적지에 대한 지도 역할을 합니다. \
데이터는 라우터로 이동하고 네트워크 요청은 정의된 라우팅 테이블에 따라 작동합니다. \
예를 들어 서브넷 A의 라우팅 테이블은 172.31.0.0/16 네트워크 범위와 일치하여 모든 로컬 트래픽이 로컬에서 해결되도록 지시합니다. \
그러나 네트워크 외부로 나가는 트래픽은 인터넷 게이트웨이 없이는 처리할 수 없습니다.

### 인터넷 게이트 웨이

인터넷 게이트웨이는 VPC를 인터넷에 연결하는 단일 진입점 역할을 합니다. \
라우팅 테이블에는 모든 트래픽을 인터넷 게이트웨이로 보내는 0.0.0.0/0 값이 추가로 있습니다. \
라우팅 테이블은 먼저 대상 주소가 172.31.0.0/16과 일치하는지 확인하고, 일치하지 않으면 트래픽을 인터넷 게이트웨이로 보냅니다.

### Nat 게이트 웨이
NAT 게이트웨이는 사설 서브넷이 인터넷과 통신하기 위한 아웃바운드 인스턴스 역할을 합니다. \
때로는 사설 네트워크에 인바운드 트래픽이 필요하지 않지만 펌웨어 업데이트 또는 정기 업데이트를 수신해야 하는 경우가 있습니다. \
이러한 경우 공용 서브넷의 NAT 게이트웨이는 사설 서브넷에서 아웃바운드 트래픽을 수신하여 인터넷 게이트웨이에 연결합니다.

### IngressOnly 게이트웨이

인그레스 전용 게이트웨이는 VPC로 들어오는 트래픽을 허용하는 동시에 동일한 VPC에서 나가는 트래픽을 차단하는 데 사용되는 특수한 유형의 게이트웨이입니다. \
인그레스 전용 게이트웨이는 모든 아웃바운드 트래픽을 차단하면서 인바운드 트래픽만 허용하는 게이트웨이입니다. \

예를 들어, 수신 전용 게이트웨이를 사용하여 공개 웹 사이트에서 VPC의 데이터베이스 서버로 들어오는 트래픽을 허용하는 동시에 데이터베이스 서버가 인터넷으로 나가는 연결을 시작하지 못하도록 할 수 있습니다. 
프라이빗 서브넷 내의 리소스에 액세스해야 하지만 아웃바운드 인터넷 액세스는 필요하지 않은 위와 같은 상황에서 유용합니다.

즉 들어오는 트래픽은 허용하고 나가는 트래픽은 차단하여 VPC 리소스에 대한 추가 보호 계층을 제공하는 보안 기능입니다. \



### 참조
https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Scenario2.html \
https://medium.com/harrythegreat/aws-%EA%B0%80%EC%9E%A5%EC%89%BD%EA%B2%8C-vpc-%EA%B0%9C%EB%85%90%EC%9E%A1%EA%B8%B0-71eef95a7098 \ 
https://www.uturndata.com/2021/02/23/aws-quick-tips-internet-gateways-nat-gateways-and-nat-instances/
