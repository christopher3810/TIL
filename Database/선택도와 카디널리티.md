
## 선택도와 카디널리티
***

<br>

### 선택도(Selectivity)

---

> 선택도란? 테이블의 특정 열을 기준으로 해당 열의 조건절(WHERE 절 조건문)에 따라 선택되는 데이터의 비율을 말함. 열에 중복되는 데이터가 많다면 ‘선택도가 높다’ 조건절에 따라 매우 많은 양의 데이터가 선택됨 열에 중복되는 데이터가 적다면 ‘선택도가 낮다’ 조건절에 따라 매우 적은 양의 데이터가 선택됨

-   8개중 1개에 새우가 들어 있다고 한다면

|  | 새우 | | | | | | | 
|--|--|--|-----|--|--|--|--|


-   A가 - 다이어트중이라 새우가 있는 한조각만 먹었고
    -   전체 중 12% 먹은셈
-   B가 - 새우가 포함된 4조각을 먹었습니다
    -   전체중 50% 먹은셈

<br>

🔥 해당 개념이 선택도로 전체 피자중 선택될 비율을 가르킵니다.\
a는 새우가 있는 한조각을 b는 여러 조각을 먹어본 뒤 새우가 들어있는 피자가 맛있는지 알수 있게 되는것 입니다.\
즉 낮은 선택도가 대용량 데이터에서 원하는 데이터만 골라내는 능력이라는것을 보여줍니다.\
낮은 선택도를 갖는 열은 데이터를 조회하는 SQL문에서 원하는 데이터를 빨리 찾기 위한 인덱스 열을 생성할때 주요 고려대상이 됩니다.

<br>

### 선택도 계산

---

> 선택도 = 선택한 데이터 건수 / 전체 데이터 건수


- 조건절 데이터 건수를 매번 계산할 수 없고 데이터의 삭제와 수정 , 삽입이 수시로 발생하는 만큼 중복이 제거된 데이터의 건수를 활용하여 선택도를 일반화 시킴.


> 변형된 선택도 = 1 / DISTINCT(COUNT 열명)


계산 예시
학생 테이블

| 학번 | 이름 | 성별 |
|--|--|--|
|10001|이순신|남|
|10002|논개|여|
|10003|곽재우|남|
|10004|신사임당|여|
|...100건|...|...|
|10100|신립|남|


> 학번 열의 선택도 = 1 / 100 = 0.01

-   저장된 데이터는 총 100건으로 기본 키에 해당하는 학번 데이터도 마찬가지로 100건.
-   어떤 학번을 선택하더라도 항상 하나의 유일한 값을 출력하는 0.01의 선택도를 가짐.

```sql
SELECT COUNT(*) //전체 데이터 건수 구하기
FROM 학생;
-> 100

SELECT COUNT(DISTINCT 학번) //학번 데이터에서 중복 제거
FROM 학생;
-> 100

SELECT 1 / COUNT(DISTINCT 학번) //선택도 구하기
FROM 학생;
->0.01
```

<br>

### 카디널리티

---

> 카디널리티는 ‘하나의 데이터 유형으로 정의되는 데이터 행의 개수’ 전체 데이터에 접근한 뒤 출력될 것이라 예상되는 데이터 건수 전체 행에 대한 특정 열의 중복 수치를 나타내는 지표로 자주 활용

> 카디널리티 계산 카디널리티 = 전체 데이터 건수 * 선택도 예시) 학번 열 카디널리티 100 * 0.01 = 1 학번 데이터가 고유한 만큼 1건의 데이터만 출력 될것이라 예측 가능


**특정 열에 중복된 값이 많다면 카디널리티 가 낮다고 할수 있다. \
해당 열을 조회하면 상당수 데이터를 거르지 못한 채 대량의 데이터가 출력될 것을 예측 가능** 
중복된 값이 적다면 카디널리티가 높다고 할수 있으며 많은 데이터를 제거한뒤 소수의 데이터만 출력될 것을 예측 가능.\
즉 중복도가 높으면 카디널리티가 낮고 중복도가 낮으면 카디널리티가 높다고 정리할 수 있습니다.


![cardinality_ex1png.png](https://user-images.githubusercontent.com/61622657/219921970-2cb8e71c-32d3-410b-942a-3ac3205e000a.png)

-   왼쪽은 중복되는 2개의 도형만 있고 일부 도형을 선택 하더라도 중복된 도형임을 확인할 수 있으므로 카디널리티가 낮음
-   오른쪽은 동일한 도형이 없으며 일부 도형을 선택하더라도 매번 다른 패턴의 도형이 확인되므로 카디널리티가 높음

> 일상 생활에서의 카디널리티 예시 
> 주민등록번호 : 카디널리티 높음(단 하나만 존재, 중복 x) 
> 이름 : 카디널리티 중간(단 하나만 존재 x, 중복도 중간) 
> 성별 : 카디널리티 높음(2가지 종류만 있으므로 중복 매우 많음 ) 유사 케이스 - 질병유무, 졸업 여부

<br>

### 참조
***
[업무에 바로 쓰는 SQL 튜닝](http://www.yes24.com/Product/Goods/102382080)
